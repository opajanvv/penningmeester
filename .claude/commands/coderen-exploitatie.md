# coderen-exploitatie

Input: $ARGUMENTS

## Doel

Bepaal de juiste grootboekrekening voor nieuwe boekingen van de exploitatie (Bethlehemkerk) op basis van omschrijving en tegenpartij.

## Gebruik

Input komt uit het Apps Script `exportOngecodeerd()` in de Google Sheet.
Elke regel heeft het formaat: `rijnummer|omschrijving, naam`

```
/coderen-exploitatie
23|factuur schoonmaak periode 12, Care
24|parkeervergunning 11, Stichting Derdengelden Parkeer Service
```

Of zonder rijnummers voor losse invoer:
```
/coderen-exploitatie Sligro factuur 123456, Sligro Food Group
```

## Coderingsregels

### Opbrengsten

| Code | Naam | Patroon |
|------|------|---------|
| 140 | Debiteuren verhuur/buffet BK | factuurnummer JJJJMM-NNN (bijv. 202601-013), VvE/VVE, zaalhuur, huur (van huurder), St. Inovum, HilverZorg, Sonnevelt, De Gitaarleraar, Prestige Vocal, Con Amore, Alzheimer, HENGELSPORTVER, COV HILVERSUM |
| 199 | Kruisposten | Collectebonnen, correctie, kruispost, doorzendcollecte |
| 410 | Buffet op rekening | Drankopbrengst (Steenvoorden) |
| 411 | Buffet contant | Kasafdracht (Van Vliet) |
| 412 | Buffet PIN | PAYPAL, PayPal |
| 404 | Verhuur ruimte pedicure | pedicure, pedicureruimte |
| 428 | Opbrengst bazar | Verkoop (marktplaats, bazar) |

### Kosten buffet

| Code | Naam | Patroon |
|------|------|---------|
| 450 | Inkoop buffet | Sligro, FAJE catering, Party en Cateringservice, Teastreet, Zavor Coffee, boodschappen kerk, koekjes |
| 455 | Afrekening personeelskosten koster | personeelskosten koster, kostervergoeding |

### Kosten gebouw

| Code | Naam | Patroon |
|------|------|---------|
| 460 | Kosten schoonmaakbedrijf | Care, Boozt24 Finance |
| 560 | Schoonmaakartikelen | GPH Schoonmaakartikelen |
| 562 | Kosten vuilafvoer | Renewi |
| 574 | Kleine aanschaf | keukengerei, kleine apparatuur |
| 579 | Overige onderhoudskosten | Micro-Projects, onderhoud apparatuur |
| 589 | Kosten tuinonderhoud | TOMA Bloemenservice, ISERO, tuin, bollen |
| 600 | Kosten parkeervoorziening | Parkeer Service, parkeervergunning |

### Overige kosten

| Code | Naam | Patroon |
|------|------|---------|
| 470 | Onderhoud vleugel/piano | Piano Select, pianostemmer |
| 480 | Bankkosten | Bankkosten, portokosten |
| 481 | Kantoorartikelen | 123inkt |
| 482 | Vergoeding vrijwilligers | vrijwilligersvergoeding, Verschoof |
| 489 | Overige diverse kosten | telefoon abonnement, overige |

### Interne boekingen

| Code | Naam | Patroon |
|------|------|---------|
| 129 | Spaargeld Centraal | Afstorting saldo, interne overboeking naar spaar |

## Prioriteit matching

1. **Factuurnummerformaat** - Omschrijving bevat JJJJMM-NNN (bijv. 202601-013) â†’ 140 (verhuurfactuur)
2. **Tegenpartij** - Exacte of gedeeltelijke match op naam
3. **Omschrijving** - Keywords in de omschrijving
4. **Bij twijfel** - Geef code 200 (Vraagposten) met opties

## Output formaat

Geef twee blokken output:

### 1. Leesbaar overzicht

Per regel: `rijnummer: CODE NAAM | omschrijving | tegenpartij`
Bij twijfel: markeer met `?` en geef opties.

```
23: 460 Kosten schoonmaakbedrijf | factuur schoonmaak periode 12 | Care
24: 600 Kosten parkeervoorziening | parkeervergunning 11 | Stichting Derdengelden Parkeer Service
49: 200 Vraagposten | onbekende boeking | Onbekend bedrijf?
```

### 2. Import-blok

Na het overzicht, geef een code-blok met het import-formaat voor het Apps Script `importGecodeerd()`.
Per regel: `rijnummer|code|opmerking`
De opmerking is alleen nodig bij code 200 (twijfelgevallen).

```
23|460|
24|600|
49|200|Onbekende boeking: verhuur (140) of overig (489)?
```

### Twijfelgevallen

Als een boeking niet duidelijk past:
- Geef code **200** (Vraagposten)
- Zet de toelichting met mogelijke codes in de opmerking

Als er geen rijnummer in de input staat, geef alleen het leesbare overzicht zonder import-blok.
